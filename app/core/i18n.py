"""Lightweight i18n helper for the Telegram bot.

This module keeps a small dictionary-based translation table so we can
respond to users in their preferred language without external services.
"""

from __future__ import annotations

from typing import Dict

# Supported language codes exposed to the user
LANGUAGES: Dict[str, str] = {
    "en": "English",
    "he": "עברית",
    "ar": "العربية",
    "ru": "Русский",
}


# Translation table. Keys are English source strings, optionally with
# ``str.format`` placeholders. Values are translated templates. Anything not
# translated falls back to the source text.
TRANSLATIONS: Dict[str, Dict[str, str]] = {
    "he": {
        "Welcome to the SLH Investor Gateway.": "ברוכים הבאים לשער ההשקעות של SLH.",
        "This bot is intended for strategic investors (minimum {min_invest:,.0f} ILS).": "הבוט מיועד למשקיעים אסטרטגיים (מינימום {min_invest:,.0f} ₪).",
        "With this bot you can:": "עם הבוט תוכלו:",
        "- Link your personal BNB wallet (BSC)": "- לקשר את ארנק ה-BNB האישי שלכם (BSC)",
        "- View your off-chain SLH balance": "- לצפות ביתרת ה-SLH האחסונית שלכם",
        "- Transfer SLH units to other investors (off-chain)": "- להעביר יחידות SLH למשקיעים אחרים (Off-Chain)",
        "- Access external links for BNB purchase and staking info": "- לגשת ללינקים חיצוניים לרכישת BNB ומידע Staking",
        "Next steps:": "מה הלאה:",
        "1) Use /link_wallet to connect your BNB (BSC) address.": "1) השתמשו ב-/link_wallet כדי לחבר כתובת BNB (BSC).",
        "1) BNB wallet linked: {address}": "1) ארנק BNB מחובר: {address}",
        "2) Once your existing investment is recorded, you will see your SLH balance via /balance.": "2) לאחר רישום ההשקעה שלכם תראו את יתרת ה-SLH דרך /balance.",
        "2) Current SLH balance: {balance:.4f} (see /balance).": "2) יתרת SLH נוכחית: {balance:.4f} (ראו /balance).",
        "3) Use /wallet to view full wallet details and ecosystem links.": "3) השתמשו ב-/wallet כדי לראות פרטי ארנק מלאים וקישורי אקו־סיסטם.",
        "4) Use /whoami to see your ID, username and wallet status.": "4) השתמשו ב-/whoami כדי לראות ID, שם משתמש ומצב ארנק.",
        "5) Use /summary for a full investor dashboard.": "5) השתמשו ב-/summary ללוח מחוונים מלא.",
        "6) Use /history to review your latest transactions.": "6) השתמשו ב-/history כדי לראות את הטרנזקציות האחרונות.",
        "You can also open /menu for a button-based experience.": "אפשר גם לפתוח /menu לחוויה עם כפתורים.",
        "SLH Wallet Bot – Help\n\n": "בוט ארנק SLH – עזרה\n\n",
        "SLH Investor Menu – choose an action:": "תפריט משקיע SLH – בחרו פעולה:",
        "SLH Wallet Overview": "סקירת ארנק SLH",
        "Your BNB address (BSC):": "כתובת ה-BNB שלכם (BSC):",
        "You have not linked a BNB address yet (see /link_wallet).": "עדיין לא קישרתם כתובת BNB (ראו /link_wallet).",
        "Community wallet address (for deposits / tracking):": "כתובת ארנק קהילה (הפקדות / מעקב):",
        "SLH token address:": "כתובת טוקן SLH:",
        "Each SLH nominally represents {price:.0f} ILS.": "כל SLH מייצג נומינלית {price:.0f} ₪.",
        "View community wallet on BscScan:": "צפו בארנק הקהילה ב-BscScan:",
        "View SLH token on BscScan:": "צפו בטוקן SLH ב-BscScan:",
        "External BNB purchase link (optional):": "קישור חיצוני לרכישת BNB (אופציונלי):",
        "BNB staking info:": "מידע על Staking ל-BNB:",
        "Address seems invalid. Usage: /link_wallet 0xyouraddress or send the address after /link_wallet.": "הכתובת אינה נראית תקינה. שימוש: /link_wallet 0xהכתובת או שלחו את הכתובת לאחר /link_wallet.",
        "Your BNB address was saved:\n{address}": "כתובת ה-BNB נשמרה:\n{address}",
        "Please send your BNB address (BSC network, usually starts with 0x...).": "שלחו את כתובת ה-BNB שלכם (רשת BSC, בדרך כלל מתחילה ב-0x...).",
        "SLH Off-Chain Balance": "יתרת SLH במערכת (Off-Chain)",
        "Current balance: {balance:.4f} SLH": "יתרה נוכחית: {balance:.4f} SLH",
        "Nominal value: {value:.2f} ILS (at {price:.0f} ILS per SLH)": "שווי נומינלי: {value:.2f} ₪ (לפי {price:.0f} ₪ ל-SLH)",
        "On-Chain view (BNB Chain):": "תצוגה על-גבי הרשת (BNB Chain):",
        "- BNB: unavailable (RPC / address / node error)": "- BNB: לא זמין (שגיאת RPC / כתובת / צומת)",
        "- SLH: unavailable (token / RPC / node error)": "- SLH: לא זמין (שגיאת טוקן / RPC / צומת)",
        "This reflects allocations recorded for you inside the system.": "היתרה משקפת הקצאות שנרשמו עבורכם במערכת.",
        "There is no redemption yet – only future usage inside the ecosystem.": "אין עדיין אפשרות פדיון – רק שימוש עתידי באקו־סיסטם.",
        "Your SLH Investor Profile": "פרופיל המשקיע שלכם ב-SLH",
        "Telegram ID: {id}": "מזהה טלגרם: {id}",
        "Username: @{username}": "שם משתמש: @{username}",
        "Username: N/A": "שם משתמש: לא קיים",
        "BNB address: {address}": "כתובת BNB: {address}",
        "Not linked yet (use /link_wallet)": "לא קושר עדיין (השתמשו ב-/link_wallet)",
        "SLH balance: {balance:.4f} SLH": "יתרת SLH: {balance:.4f} SLH",
        "Share your Telegram ID with the SLH team if needed for allocations.": "שתפו את מזהה הטלגרם שלכם עם צוות SLH במידת הצורך להקצאות.",
        "SLH Investor Dashboard": "דשבורד משקיע SLH",
        "Profile:": "פרופיל:",
        "- Telegram ID: {id}": "- מזהה טלגרם: {id}",
        "- Username: @{username}": "- שם משתמש: @{username}",
        "- Username: N/A": "- שם משתמש: לא קיים",
        "- Investor tier: {tier}": "- דרגת משקיע: {tier}",
        "Wallets:": "ארנקים:",
        "- Your BNB (BSC): {address}": "- ה-BNB שלכם (BSC): {address}",
        "- Community wallet: {address}": "- ארנק קהילה: {address}",
        "- SLH token: {address}": "- טוקן SLH: {address}",
        "Balance (Off-Chain System Ledger):": "יתרה (לג'ר פנימי):",
        "- SLH: {balance:.4f} SLH": "- SLH: {balance:.4f} SLH",
        "- Nominal ILS value: {value:.2f} ILS": "- שווי נומינלי בש""ח: {value:.2f} ₪",
        "- Hypothetical yearly yield (10%): {yield_amount:.4f} SLH": "- תשואה היפותטית שנתית (10%): {yield_amount:.4f} SLH",
        "On-Chain (BNB Chain) – based on your BNB address:": "תצוגת On-Chain (BNB Chain) על בסיס כתובת ה-BNB שלכם:",
        "- BNB: unavailable (RPC or address error)": "- BNB: לא זמין (שגיאת RPC או כתובת)",
        "- SLH: unavailable (token or RPC error)": "- SLH: לא זמין (שגיאת טוקן או RPC)",
        "On BscScan:": "ב-BscScan:",
        "Investor Docs: {url}": "מסמכי משקיעים: {url}",
        "Key commands: /menu, /wallet, /balance, /history, /transfer, /docs, /help": "פקודות מרכזיות: /menu, /wallet, /balance, /history, /transfer, /docs, /help",
        "Use /docs to view the official investor documentation.": "השתמשו ב-/docs כדי לצפות בתיעוד המשקיעים הרשמי.",
        "Docs URL is not configured yet.": "כתובת המסמכים עדיין לא הוגדרה.",
        "SLH Investor Documentation": "תיעוד המשקיעים של SLH",
        "The full investor deck, ecosystem overview and technical docs are available here:": "מצגת משקיעים מלאה, סקירת אקו־סיסטם ותיעוד טכני זמינים כאן:",
        "You can share this link with potential strategic partners and investors.": "אפשר לשתף את הקישור עם שותפים ואנשי השקעה פוטנציאליים.",
        "Showing last {count} transactions:": "מציג {count} הטרנזקציות האחרונות:",
        "No transactions found for your account yet.": "לא נמצאו טרנזקציות לחשבון שלכם עדיין.",
        "Transfer completed:\n{amount:.4f} SLH -> @{username}\nTransaction ID: {tx_id}": "העברה הושלמה:\n{amount:.4f} SLH -> @{username}\nמזהה טרנזקציה: {tx_id}",
        "This command is admin-only.": "הפקודה מיועדת לאדמין בלבד.",
        "Usage: /admin_credit <telegram_id> <amount_slh>": "שימוש: /admin_credit <telegram_id> <amount_slh>",
        "Invalid parameters. Check ID and amount.": "פרמטרים לא תקינים. בדקו מזהה וסכום.",
        "Credited {amount:.4f} SLH to user {user_id}.\nTransaction ID: {tx_id}": "זוכו {amount:.4f} SLH למשתמש {user_id}.\nמזהה טרנזקציה: {tx_id}",
        "SLH Admin Menu – tools for managing investor balances:": "תפריט אדמין SLH – כלים לניהול יתרות משקיעים:",
        "No users found in the system yet.": "לא נמצאו משתמשים במערכת עדיין.",
        "Admin – Users (top 50 by SLH balance):": "אדמין – משתמשים (50 ראשונים לפי יתרת SLH):",
        "Admin – Global Ledger (last 50 transactions):": "אדמין – לג'ר גלובלי (50 טרנזקציות אחרונות):",
        "No transactions in the ledger yet.": "אין טרנזקציות בלג'ר עדיין.",
        "BUY_BNB_URL not set in environment variables.": "המשתנה BUY_BNB_URL לא הוגדר בסביבה.",
        "Send a username starting with @username": "שלחו שם משתמש שמתחיל ב-@username",
        "Great. Now type the SLH amount you want to transfer to {username}.": "מצוין. עכשיו הקלידו את סכום ה-SLH להעברה ל-{username}.",
        "Could not read amount. Try again with /transfer.": "לא הצלחתי לקרוא את הסכום. נסו שוב עם /transfer.",
        "Amount must be greater than zero.": "הסכום חייב להיות גדול מאפס.",
        "Target not found. Try again with /transfer.": "היעד לא נמצא. נסו שוב עם /transfer.",
        "No user with that username in the system. They must send /start once before receiving transfers.": "אין משתמש עם שם כזה במערכת. עליו לשלוח /start פעם אחת לפני קבלת העברות.",
        "Insufficient balance for this transfer.": "יתרה לא מספיקה להעברה זו.",
        "Command not recognized. Use /help to see available commands.": "הפקודה לא זוהתה. השתמשו ב-/help כדי לראות פקודות זמינות.",
        "Type the target username you want to transfer to (e.g. @username).": "הקלידו את שם המשתמש שאליו תרצו להעביר (לדוגמה @username).",
        "Usage: /send_slh <amount> <@username|user_id>": "שימוש: /send_slh <amount> <@username|user_id>",
        "Invalid amount.": "סכום לא תקין.",
        "Invalid target format.": "פורמט יעד לא תקין.",
        "Target user not found in the system. They must send /start once.": "משתמש היעד לא נמצא במערכת. עליו לשלוח /start פעם אחת.",
        "SLH Admin Menu – choose a help topic:": "תפריט עזרה לאדמין SLH – בחרו נושא:",
        "Wallet": "ארנק",
        "Balance": "יתרה",
        "History": "היסטוריה",
        "Transfer": "העברה",
        "Docs": "מסמכים",
        "Summary": "סיכום",
        "Link Wallet": "קישור ארנק",
        "Main menu updated.": "תפריט ראשי עודכן.",
        "Language": "שפה",
        "Choose your language:": "בחרו את השפה שלכם:",
        "Language updated to {language_name}.": "השפה עודכנה ל-{language_name}.",
        "Your language is currently {language_name}.": "השפה הנוכחית שלכם היא {language_name}.",
        "You have not linked a BNB address yet. Use /link_wallet first.": "עדיין לא קישרתם כתובת BNB. השתמשו ב-/link_wallet תחילה.",
        "On-chain RPC is not configured on the server (BSC_RPC_URL missing).": "RPC ל-On-Chain לא מוגדר בשרת (חסר BSC_RPC_URL).",
        "Failed to fetch on-chain balances (RPC or token error).": "נכשל בשליפת יתרות On-Chain (שגיאת RPC או טוקן).",
        "On-Chain Balances (BNB Smart Chain)": "יתרות On-Chain (BNB Smart Chain)",
        "Address: {address}": "כתובת: {address}",
        "- Wallet: {address}": "- ארנק: {address}",
        "SLH Investor Menu – choose an action:": "תפריט משקיע SLH – בחרו פעולה:",
        "Last transactions (internal ledger)": "טרנזקציות אחרונות (לג'ר פנימי)",
        "Most recent first (max 10):": "החדשות ביותר ראשונות (עד 10)",
        "Could not load transaction history. Please contact the SLH team.": "לא ניתן היה לטעון היסטוריית טרנזקציות. צרו קשר עם צוות SLH.",
    },
    "ar": {
        "Welcome to the SLH Investor Gateway.": "مرحبًا بكم في بوابة مستثمري SLH.",
        "This bot is intended for strategic investors (minimum {min_invest:,.0f} ILS).": "هذا البوت مخصص للمستثمرين الاستراتيجيين (حد أدنى {min_invest:,.0f} شيكل).",
        "With this bot you can:": "مع هذا البوت يمكنك:",
        "- Link your personal BNB wallet (BSC)": "- ربط محفظة BNB الشخصية الخاصة بك (BSC)",
        "- View your off-chain SLH balance": "- عرض رصيد SLH خارج السلسلة",
        "- Transfer SLH units to other investors (off-chain)": "- تحويل وحدات SLH إلى مستثمرين آخرين (خارج السلسلة)",
        "- Access external links for BNB purchase and staking info": "- الوصول إلى روابط خارجية لشراء BNB ومعلومات التخزين",
        "Next steps:": "الخطوات التالية:",
        "1) Use /link_wallet to connect your BNB (BSC) address.": "1) استخدم /link_wallet لربط عنوان BNB (BSC) الخاص بك.",
        "1) BNB wallet linked: {address}": "1) تم ربط محفظة BNB: {address}",
        "2) Once your existing investment is recorded, you will see your SLH balance via /balance.": "2) بعد تسجيل استثمارك الحالي سترى رصيد SLH عبر /balance.",
        "2) Current SLH balance: {balance:.4f} (see /balance).": "2) رصيد SLH الحالي: {balance:.4f} (راجع /balance).",
        "3) Use /wallet to view full wallet details and ecosystem links.": "3) استخدم /wallet لعرض تفاصيل المحفظة وروابط النظام البيئي.",
        "4) Use /whoami to see your ID, username and wallet status.": "4) استخدم /whoami لرؤية المعرف واسم المستخدم وحالة المحفظة.",
        "5) Use /summary for a full investor dashboard.": "5) استخدم /summary للحصول على لوحة معلومات كاملة للمستثمر.",
        "6) Use /history to review your latest transactions.": "6) استخدم /history لمراجعة آخر معاملاتك.",
        "You can also open /menu for a button-based experience.": "يمكنك أيضًا فتح /menu لتجربة قائمة أزرار.",
        "SLH Wallet Bot – Help\n\n": "بوت محفظة SLH – مساعدة\n\n",
        "SLH Investor Menu – choose an action:": "قائمة مستثمر SLH – اختر إجراءً:",
        "SLH Wallet Overview": "نظرة عامة على محفظة SLH",
        "Your BNB address (BSC):": "عنوان BNB الخاص بك (BSC):",
        "You have not linked a BNB address yet (see /link_wallet).": "لم تربط عنوان BNB بعد (راجع /link_wallet).",
        "Community wallet address (for deposits / tracking):": "عنوان محفظة المجتمع (للإيداع / التتبع):",
        "SLH token address:": "عنوان رمز SLH:",
        "Each SLH nominally represents {price:.0f} ILS.": "كل SLH يمثل اسميًا {price:.0f} شيكل.",
        "View community wallet on BscScan:": "عرض محفظة المجتمع على BscScan:",
        "View SLH token on BscScan:": "عرض رمز SLH على BscScan:",
        "External BNB purchase link (optional):": "رابط خارجي لشراء BNB (اختياري):",
        "BNB staking info:": "معلومات تخزين BNB:",
        "Address seems invalid. Usage: /link_wallet 0xyouraddress or send the address after /link_wallet.": "يبدو العنوان غير صالح. الاستخدام: /link_wallet 0xعنوانك أو أرسل العنوان بعد /link_wallet.",
        "Your BNB address was saved:\n{address}": "تم حفظ عنوان BNB الخاص بك:\n{address}",
        "Please send your BNB address (BSC network, usually starts with 0x...).": "أرسل عنوان BNB الخاص بك (شبكة BSC، عادة يبدأ بـ 0x...).",
        "SLH Off-Chain Balance": "رصيد SLH خارج السلسلة",
        "Current balance: {balance:.4f} SLH": "الرصيد الحالي: {balance:.4f} SLH",
        "Nominal value: {value:.2f} ILS (at {price:.0f} ILS per SLH)": "القيمة الاسمية: {value:.2f} شيكل (بسعر {price:.0f} شيكل لكل SLH)",
        "On-Chain view (BNB Chain):": "عرض على السلسلة (BNB Chain):",
        "- BNB: unavailable (RPC / address / node error)": "- BNB: غير متاح (خطأ RPC / عنوان / عقدة)",
        "- SLH: unavailable (token / RPC / node error)": "- SLH: غير متاح (خطأ رمز / RPC / عقدة)",
        "This reflects allocations recorded for you inside the system.": "هذا يعكس المخصصات المسجلة لك داخل النظام.",
        "There is no redemption yet – only future usage inside the ecosystem.": "لا يوجد استرداد حتى الآن – فقط استخدام مستقبلي داخل النظام البيئي.",
        "Your SLH Investor Profile": "ملف مستثمر SLH الخاص بك",
        "Telegram ID: {id}": "معرف تيليجرام: {id}",
        "Username: @{username}": "اسم المستخدم: @{username}",
        "Username: N/A": "اسم المستخدم: غير متوفر",
        "BNB address: {address}": "عنوان BNB: {address}",
        "Not linked yet (use /link_wallet)": "لم يتم الربط بعد (استخدم /link_wallet)",
        "SLH balance: {balance:.4f} SLH": "رصيد SLH: {balance:.4f} SLH",
        "Share your Telegram ID with the SLH team if needed for allocations.": "شارك معرف تيليجرام مع فريق SLH عند الحاجة للمخصصات.",
        "SLH Investor Dashboard": "لوحة معلومات مستثمري SLH",
        "Profile:": "الملف الشخصي:",
        "- Telegram ID: {id}": "- معرف تيليجرام: {id}",
        "- Username: @{username}": "- اسم المستخدم: @{username}",
        "- Username: N/A": "- اسم المستخدم: غير متوفر",
        "- Investor tier: {tier}": "- فئة المستثمر: {tier}",
        "Wallets:": "المحافظ:",
        "- Your BNB (BSC): {address}": "- محفظة BNB الخاصة بك (BSC): {address}",
        "- Community wallet: {address}": "- محفظة المجتمع: {address}",
        "- SLH token: {address}": "- رمز SLH: {address}",
        "Balance (Off-Chain System Ledger):": "الرصيد (دفتر النظام الداخلي):",
        "- SLH: {balance:.4f} SLH": "- SLH: {balance:.4f} SLH",
        "- Nominal ILS value: {value:.2f} ILS": "- القيمة الاسمية بالشيكل: {value:.2f} شيكل",
        "- Hypothetical yearly yield (10%): {yield_amount:.4f} SLH": "- عائد سنوي افتراضي (10%): {yield_amount:.4f} SLH",
        "On-Chain (BNB Chain) – based on your BNB address:": "على السلسلة (BNB Chain) – بناءً على عنوان BNB الخاص بك:",
        "- BNB: unavailable (RPC or address error)": "- BNB: غير متاح (خطأ RPC أو عنوان)",
        "- SLH: unavailable (token or RPC error)": "- SLH: غير متاح (خطأ رمز أو RPC)",
        "On BscScan:": "على BscScan:",
        "Investor Docs: {url}": "وثائق المستثمر: {url}",
        "Key commands: /menu, /wallet, /balance, /history, /transfer, /docs, /help": "الأوامر الرئيسية: /menu, /wallet, /balance, /history, /transfer, /docs, /help",
        "Use /docs to view the official investor documentation.": "استخدم /docs لعرض وثائق المستثمر الرسمية.",
        "Docs URL is not configured yet.": "رابط الوثائق غير مضبوط بعد.",
        "SLH Investor Documentation": "توثيق مستثمري SLH",
        "The full investor deck, ecosystem overview and technical docs are available here:": "عرض المستثمرين الكامل ونظرة عامة على النظام البيئي والمستندات التقنية متاحة هنا:",
        "You can share this link with potential strategic partners and investors.": "يمكنك مشاركة هذا الرابط مع الشركاء الاستراتيجيين والمستثمرين المحتملين.",
        "Showing last {count} transactions:": "عرض آخر {count} معاملات:",
        "No transactions found for your account yet.": "لا توجد معاملات لحسابك بعد.",
        "Transfer completed:\n{amount:.4f} SLH -> @{username}\nTransaction ID: {tx_id}": "تم التحويل:\n{amount:.4f} SLH -> @{username}\nمعرّف المعاملة: {tx_id}",
        "This command is admin-only.": "هذا الأمر مخصص للمشرف فقط.",
        "Usage: /admin_credit <telegram_id> <amount_slh>": "الاستخدام: /admin_credit <telegram_id> <amount_slh>",
        "Invalid parameters. Check ID and amount.": "معلمات غير صالحة. تحقق من المعرف والمبلغ.",
        "Credited {amount:.4f} SLH to user {user_id}.\nTransaction ID: {tx_id}": "تم إضافة {amount:.4f} SLH للمستخدم {user_id}.\nمعرّف المعاملة: {tx_id}",
        "SLH Admin Menu – tools for managing investor balances:": "قائمة إدارة SLH – أدوات لإدارة أرصدة المستثمرين:",
        "No users found in the system yet.": "لا يوجد مستخدمون في النظام بعد.",
        "Admin – Users (top 50 by SLH balance):": "المشرف – المستخدمون (أعلى 50 حسب رصيد SLH):",
        "Admin – Global Ledger (last 50 transactions):": "المشرف – دفتر عام (آخر 50 معاملة):",
        "No transactions in the ledger yet.": "لا توجد معاملات في الدفتر بعد.",
        "BUY_BNB_URL not set in environment variables.": "لم يتم تعيين BUY_BNB_URL في متغيرات البيئة.",
        "Send a username starting with @username": "أرسل اسم مستخدم يبدأ بـ @username",
        "Great. Now type the SLH amount you want to transfer to {username}.": "رائع. الآن اكتب مبلغ SLH الذي تريد تحويله إلى {username}.",
        "Could not read amount. Try again with /transfer.": "تعذر قراءة المبلغ. حاول مرة أخرى باستخدام /transfer.",
        "Amount must be greater than zero.": "يجب أن يكون المبلغ أكبر من صفر.",
        "Target not found. Try again with /transfer.": "الهدف غير موجود. حاول مرة أخرى باستخدام /transfer.",
        "No user with that username in the system. They must send /start once before receiving transfers.": "لا يوجد مستخدم بهذا الاسم في النظام. يجب أن يرسل /start مرة واحدة قبل استقبال التحويلات.",
        "Insufficient balance for this transfer.": "رصيد غير كافٍ لهذا التحويل.",
        "Command not recognized. Use /help to see available commands.": "الأمر غير معروف. استخدم /help لرؤية الأوامر المتاحة.",
        "Type the target username you want to transfer to (e.g. @username).": "اكتب اسم المستخدم المستهدف للتحويل (مثلاً @username).",
        "Usage: /send_slh <amount> <@username|user_id>": "الاستخدام: /send_slh <amount> <@username|user_id>",
        "Invalid amount.": "مبلغ غير صالح.",
        "Invalid target format.": "تنسيق هدف غير صالح.",
        "Target user not found in the system. They must send /start once.": "لم يتم العثور على المستخدم الهدف في النظام. يجب أن يرسل /start مرة واحدة.",
        "SLH Admin Menu – choose a help topic:": "قائمة مساعدة المشرف SLH – اختر موضوعًا:",
        "Wallet": "محفظة",
        "Balance": "رصيد",
        "History": "تاريخ",
        "Transfer": "تحويل",
        "Docs": "وثائق",
        "Summary": "ملخص",
        "Link Wallet": "ربط المحفظة",
        "Main menu updated.": "تم تحديث القائمة الرئيسية.",
        "Language": "اللغة",
        "Choose your language:": "اختر لغتك:",
        "Language updated to {language_name}.": "تم تحديث اللغة إلى {language_name}.",
        "Your language is currently {language_name}.": "لغتك الحالية هي {language_name}.",
        "You have not linked a BNB address yet. Use /link_wallet first.": "لم تربط عنوان BNB بعد. استخدم /link_wallet أولاً.",
        "On-chain RPC is not configured on the server (BSC_RPC_URL missing).": "لم يتم تهيئة RPC على السلسلة على الخادم (BSC_RPC_URL مفقود).",
        "Failed to fetch on-chain balances (RPC or token error).": "فشل في جلب الأرصدة على السلسلة (خطأ في RPC أو الرمز).",
        "On-Chain Balances (BNB Smart Chain)": "أرصدة على السلسلة (BNB Smart Chain)",
        "Address: {address}": "العنوان: {address}",
        "- Wallet: {address}": "- المحفظة: {address}",
        "SLH Investor Menu – choose an action:": "قائمة مستثمر SLH – اختر إجراءً:",
        "Last transactions (internal ledger)": "آخر المعاملات (دفتر داخلي)",
        "Most recent first (max 10):": "الأحدث أولاً (بحد أقصى 10)",
        "Could not load transaction history. Please contact the SLH team.": "تعذر تحميل سجل المعاملات. يرجى التواصل مع فريق SLH.",
    },
    "ru": {
        "Welcome to the SLH Investor Gateway.": "Добро пожаловать в инвестиционный шлюз SLH.",
        "This bot is intended for strategic investors (minimum {min_invest:,.0f} ILS).": "Этот бот предназначен для стратегических инвесторов (минимум {min_invest:,.0f} шекелей).",
        "With this bot you can:": "С помощью бота вы можете:",
        "- Link your personal BNB wallet (BSC)": "- привязать личный кошелёк BNB (BSC)",
        "- View your off-chain SLH balance": "- просматривать баланс SLH в системе",
        "- Transfer SLH units to other investors (off-chain)": "- переводить SLH другим инвесторам (off-chain)",
        "- Access external links for BNB purchase and staking info": "- перейти по внешним ссылкам для покупки BNB и информации о стейкинге",
        "Next steps:": "Следующие шаги:",
        "1) Use /link_wallet to connect your BNB (BSC) address.": "1) Используйте /link_wallet, чтобы подключить адрес BNB (BSC).",
        "1) BNB wallet linked: {address}": "1) Кошелёк BNB подключён: {address}",
        "2) Once your existing investment is recorded, you will see your SLH balance via /balance.": "2) После фиксации текущей инвестиции вы увидите баланс SLH через /balance.",
        "2) Current SLH balance: {balance:.4f} (see /balance).": "2) Текущий баланс SLH: {balance:.4f} (см. /balance).",
        "3) Use /wallet to view full wallet details and ecosystem links.": "3) Используйте /wallet, чтобы увидеть детали кошелька и ссылки экосистемы.",
        "4) Use /whoami to see your ID, username and wallet status.": "4) /whoami покажет ваш ID, имя пользователя и статус кошелька.",
        "5) Use /summary for a full investor dashboard.": "5) /summary – полный дашборд инвестора.",
        "6) Use /history to review your latest transactions.": "6) /history – последние транзакции.",
        "You can also open /menu for a button-based experience.": "Также можно открыть /menu для управления кнопками.",
        "SLH Wallet Bot – Help\n\n": "Бот кошелька SLH – помощь\n\n",
        "SLH Investor Menu – choose an action:": "Меню инвестора SLH – выберите действие:",
        "SLH Wallet Overview": "Обзор кошелька SLH",
        "Your BNB address (BSC):": "Ваш адрес BNB (BSC):",
        "You have not linked a BNB address yet (see /link_wallet).": "Адрес BNB ещё не привязан (см. /link_wallet).",
        "Community wallet address (for deposits / tracking):": "Адрес общинного кошелька (для депозитов/отслеживания):",
        "SLH token address:": "Адрес токена SLH:",
        "Each SLH nominally represents {price:.0f} ILS.": "Каждый SLH номинально равен {price:.0f} шекелей.",
        "View community wallet on BscScan:": "Смотреть общинный кошелёк на BscScan:",
        "View SLH token on BscScan:": "Смотреть токен SLH на BscScan:",
        "External BNB purchase link (optional):": "Внешняя ссылка для покупки BNB (опционально):",
        "BNB staking info:": "Информация о стейкинге BNB:",
        "Address seems invalid. Usage: /link_wallet 0xyouraddress or send the address after /link_wallet.": "Адрес выглядит недействительным. Использование: /link_wallet 0xвашадрес или отправьте адрес после /link_wallet.",
        "Your BNB address was saved:\n{address}": "Ваш адрес BNB сохранён:\n{address}",
        "Please send your BNB address (BSC network, usually starts with 0x...).": "Отправьте адрес BNB (сеть BSC, обычно начинается с 0x...).",
        "SLH Off-Chain Balance": "Баланс SLH (off-chain)",
        "Current balance: {balance:.4f} SLH": "Текущий баланс: {balance:.4f} SLH",
        "Nominal value: {value:.2f} ILS (at {price:.0f} ILS per SLH)": "Номинальная стоимость: {value:.2f} шекелей (по {price:.0f} за SLH)",
        "On-Chain view (BNB Chain):": "On-chain (BNB Chain):",
        "- BNB: unavailable (RPC / address / node error)": "- BNB: недоступно (ошибка RPC/адреса/ноды)",
        "- SLH: unavailable (token / RPC / node error)": "- SLH: недоступно (ошибка токена/RPC/ноды)",
        "This reflects allocations recorded for you inside the system.": "Это отображает распределения, записанные для вас в системе.",
        "There is no redemption yet – only future usage inside the ecosystem.": "Пока нет выкупа – только будущие операции внутри экосистемы.",
        "Your SLH Investor Profile": "Ваш профиль инвестора SLH",
        "Telegram ID: {id}": "ID Telegram: {id}",
        "Username: @{username}": "Имя пользователя: @{username}",
        "Username: N/A": "Имя пользователя: отсутствует",
        "BNB address: {address}": "Адрес BNB: {address}",
        "Not linked yet (use /link_wallet)": "Ещё не привязан (используйте /link_wallet)",
        "SLH balance: {balance:.4f} SLH": "Баланс SLH: {balance:.4f} SLH",
        "Share your Telegram ID with the SLH team if needed for allocations.": "При необходимости поделитесь своим Telegram ID с командой SLH для распределений.",
        "SLH Investor Dashboard": "Дашборд инвестора SLH",
        "Profile:": "Профиль:",
        "- Telegram ID: {id}": "- ID Telegram: {id}",
        "- Username: @{username}": "- Имя пользователя: @{username}",
        "- Username: N/A": "- Имя пользователя: отсутствует",
        "- Investor tier: {tier}": "- Уровень инвестора: {tier}",
        "Wallets:": "Кошельки:",
        "- Your BNB (BSC): {address}": "- Ваш BNB (BSC): {address}",
        "- Community wallet: {address}": "- Кошелёк сообщества: {address}",
        "- SLH token: {address}": "- Токен SLH: {address}",
        "Balance (Off-Chain System Ledger):": "Баланс (внутренняя книга учёта):",
        "- SLH: {balance:.4f} SLH": "- SLH: {balance:.4f} SLH",
        "- Nominal ILS value: {value:.2f} ILS": "- Номинальная стоимость в шекелях: {value:.2f}",
        "- Hypothetical yearly yield (10%): {yield_amount:.4f} SLH": "- Гипотетическая годовая доходность (10%): {yield_amount:.4f} SLH",
        "On-Chain (BNB Chain) – based on your BNB address:": "On-chain (BNB Chain) на основе вашего адреса BNB:",
        "- BNB: unavailable (RPC or address error)": "- BNB: недоступно (ошибка RPC или адреса)",
        "- SLH: unavailable (token or RPC error)": "- SLH: недоступно (ошибка токена или RPC)",
        "On BscScan:": "На BscScan:",
        "Investor Docs: {url}": "Документация инвестора: {url}",
        "Key commands: /menu, /wallet, /balance, /history, /transfer, /docs, /help": "Ключевые команды: /menu, /wallet, /balance, /history, /transfer, /docs, /help",
        "Use /docs to view the official investor documentation.": "Используйте /docs, чтобы открыть официальную документацию инвестора.",
        "Docs URL is not configured yet.": "Ссылка на документы ещё не настроена.",
        "SLH Investor Documentation": "Документация инвестора SLH",
        "The full investor deck, ecosystem overview and technical docs are available here:": "Полная презентация для инвесторов, обзор экосистемы и технические документы доступны здесь:",
        "You can share this link with potential strategic partners and investors.": "Вы можете поделиться ссылкой с потенциальными стратегическими партнёрами и инвесторами.",
        "Showing last {count} transactions:": "Показываем последние {count} транзакций:",
        "No transactions found for your account yet.": "Для вашего аккаунта пока нет транзакций.",
        "Transfer completed:\n{amount:.4f} SLH -> @{username}\nTransaction ID: {tx_id}": "Перевод выполнен:\n{amount:.4f} SLH -> @{username}\nID транзакции: {tx_id}",
        "This command is admin-only.": "Эта команда только для администратора.",
        "Usage: /admin_credit <telegram_id> <amount_slh>": "Использование: /admin_credit <telegram_id> <amount_slh>",
        "Invalid parameters. Check ID and amount.": "Неверные параметры. Проверьте ID и сумму.",
        "Credited {amount:.4f} SLH to user {user_id}.\nTransaction ID: {tx_id}": "Начислено {amount:.4f} SLH пользователю {user_id}.\nID транзакции: {tx_id}",
        "SLH Admin Menu – tools for managing investor balances:": "Админ-меню SLH – инструменты для управления балансами инвесторов:",
        "No users found in the system yet.": "В системе пока нет пользователей.",
        "Admin – Users (top 50 by SLH balance):": "Админ – пользователи (топ-50 по балансу SLH):",
        "Admin – Global Ledger (last 50 transactions):": "Админ – общий реестр (последние 50 транзакций):",
        "No transactions in the ledger yet.": "В реестре пока нет транзакций.",
        "BUY_BNB_URL not set in environment variables.": "BUY_BNB_URL не задан в переменных окружения.",
        "Send a username starting with @username": "Отправьте имя пользователя, начинающееся с @username",
        "Great. Now type the SLH amount you want to transfer to {username}.": "Отлично. Теперь введите сумму SLH для перевода пользователю {username}.",
        "Could not read amount. Try again with /transfer.": "Не удалось прочитать сумму. Попробуйте снова через /transfer.",
        "Amount must be greater than zero.": "Сумма должна быть больше нуля.",
        "Target not found. Try again with /transfer.": "Цель не найдена. Попробуйте снова с /transfer.",
        "No user with that username in the system. They must send /start once before receiving transfers.": "Пользователь с таким именем в системе не найден. Он должен отправить /start один раз.",
        "Insufficient balance for this transfer.": "Недостаточный баланс для перевода.",
        "Command not recognized. Use /help to see available commands.": "Команда не распознана. Используйте /help для списка доступных команд.",
        "Type the target username you want to transfer to (e.g. @username).": "Введите имя пользователя для перевода (например, @username).",
        "Usage: /send_slh <amount> <@username|user_id>": "Использование: /send_slh <amount> <@username|user_id>",
        "Invalid amount.": "Неверная сумма.",
        "Invalid target format.": "Неверный формат цели.",
        "Target user not found in the system. They must send /start once.": "Пользователь-цель не найден. Ему нужно один раз отправить /start.",
        "SLH Admin Menu – choose a help topic:": "Админ-меню SLH – выберите тему помощи:",
        "Wallet": "Кошелёк",
        "Balance": "Баланс",
        "History": "История",
        "Transfer": "Перевод",
        "Docs": "Документы",
        "Summary": "Сводка",
        "Link Wallet": "Привязать кошелёк",
        "Main menu updated.": "Главное меню обновлено.",
        "Language": "Язык",
        "Choose your language:": "Выберите язык:",
        "Language updated to {language_name}.": "Язык обновлён на {language_name}.",
        "Your language is currently {language_name}.": "Ваш текущий язык: {language_name}.",
        "You have not linked a BNB address yet. Use /link_wallet first.": "Адрес BNB ещё не привязан. Используйте /link_wallet сначала.",
        "On-chain RPC is not configured on the server (BSC_RPC_URL missing).": "On-chain RPC не настроен на сервере (отсутствует BSC_RPC_URL).",
        "Failed to fetch on-chain balances (RPC or token error).": "Не удалось получить балансы on-chain (ошибка RPC или токена).",
        "On-Chain Balances (BNB Smart Chain)": "Балансы on-chain (BNB Smart Chain)",
        "Address: {address}": "Адрес: {address}",
        "- Wallet: {address}": "- Кошелёк: {address}",
        "SLH Investor Menu – choose an action:": "Меню инвестора SLH – выберите действие:",
        "Last transactions (internal ledger)": "Последние транзакции (внутренний реестр)",
        "Most recent first (max 10):": "Сначала самые новые (макс. 10)",
        "Could not load transaction history. Please contact the SLH team.": "Не удалось загрузить историю транзакций. Свяжитесь с командой SLH.",
    },
}


def t(lang: str | None, text: str, **kwargs) -> str:
    """Translate ``text`` according to the chosen ``lang``.

    Unknown languages or missing entries fall back to the source text. Extra
    keyword arguments are applied with ``str.format`` for dynamic content.
    """

    lang = lang or "en"
    template = TRANSLATIONS.get(lang, {}).get(text, text)
    try:
        return template.format(**kwargs)
    except Exception:
        # If formatting fails, return the raw template to avoid crashing the bot
        return template
